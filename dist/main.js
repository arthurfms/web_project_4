!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._selector=e,this._popup=document.querySelector(".".concat(e)),this._closeButton=this._popup.querySelector(".".concat(e,"__close-button"))}var n,o;return n=t,(o=[{key:"open",value:function(){this._popup.classList.add("".concat(this._selector,"_opened"))}},{key:"close",value:function(){this._popup.classList.remove("".concat(this._selector,"_opened"))}},{key:"_handleEscClose",value:function(e){"Escape"==e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;document.addEventListener("keyup",(function(t){e._handleEscClose(t)})),this._popup.addEventListener("click",(function(t){t.target.classList.contains("".concat(e._selector,"_opened"))&&e.close()})),this._closeButton.addEventListener("click",(function(){e.close()}))}}])&&e(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=n,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,o;return t=e,(o=[{key:"setEventListeners",value:function(){var e=this;this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._toggleSubmitButton(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitButton()}))}))}},{key:"_toggleSubmitButton",value:function(){this._hasInvalidInput(this._inputList)?this._buttonElement.classList.add(this._inactiveButtonClass):this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}}])&&n(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=u(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},s.apply(this,arguments)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,o,r,u=(o=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(o);if(r){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=u.call(this,e))._image=t._popup.querySelector(".image-popup__image"),t._subtitle=t._popup.querySelector(".image-popup__subtitle"),t}return t=f,(n=[{key:"open",value:function(e,t){this._image.src=e,this._image.alt=t,this._subtitle.textContent=t,s(l(f.prototype),"open",this).call(this)}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(t),p=[{name:"Vale de Yosemite",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lago Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Montanhas Carecas",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Parque Nacional da Vanoise ",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],d=document.querySelector(".info__edit-button"),h=document.querySelector(".add-button"),_=new f("image-popup"),y=document.querySelector(".info__name"),b=document.querySelector(".info__job"),v=document.querySelector("#name-input"),m=document.querySelector("#job-input"),k=(document.querySelector(".popup_user"),document.querySelector(".popup_card"),{formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input_type_error_active"});function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function C(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(u,e);var t,n,r,i,s=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(i){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return C(this,e)});function u(e){var t,n=e.selector,o=e.sending;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,n))._form=document.querySelector(".".concat(t._selector)).querySelector(".form"),t._inputs={},t._closeButton=document.querySelector(".".concat(t._selector)).querySelector(".popup__close-button"),t._sendButton=t._form.querySelector(".form__submit"),t._sending=o,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this;return this._inputsList.forEach((function(t){var n=t.id;e._inputs["".concat(n)]=t.value})),this._inputs}},{key:"_cleanInputsValues",value:function(){this._inputsList.forEach((function(e){e.value=""}))}},{key:"open",value:function(){this._inputsList=this._form.querySelectorAll(".form__input"),new o(k,this._form).setEventListeners(),this._popup.classList.add("popup_opened")}},{key:"close",value:function(){document.removeEventListener("keyup",this.boundHandleEscClose),this._popup.removeEventListener("click",this.boundHandleClickOut),this._sendButton.removeEventListener("click",this.boundAdding),this._closeButton.removeEventListener("click",this.boundClose),this._sendButton.removeEventListener("click",this.boundAdding),this._popup.classList.remove("popup_opened"),this._cleanInputsValues()}},{key:"_adding",value:function(e){e.preventDefault(),this._sending()}},{key:"_handleEnter",value:function(e){"Enter"==e.key&&this._sendButton.classList.contains("form__submit_inactive")&&e.preventDefault()}},{key:"_handleClickOut",value:function(e){e.target.classList.contains("popup_opened")&&this.close()}},{key:"setEventListeners",value:function(){this.boundClose=this.close.bind(this),this.boundHandleEscClose=this._handleEscClose.bind(this),this.boundHandleClickOut=this._handleClickOut.bind(this),this.boundAdding=this._adding.bind(this),this.boundHandleEnter=this._handleEnter.bind(this),document.addEventListener("keyup",this.boundHandleEscClose),this._popup.addEventListener("click",this.boundHandleClickOut),this._closeButton.addEventListener("click",this.boundClose),this._sendButton.addEventListener("click",this.boundAdding),document.addEventListener("keydown",this.boundHandleEnter)}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(t);function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var O=function(){function e(t,n,o){var r=o.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=t.name,this._image=t.link,this._cardSelector=n,this._isLiked=!1,this.handleCardClick=r}var t,n;return t=e,(n=[{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._setEventListeners(),this._setImage(),this._setTitle(),this._element}},{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}},{key:"_setImage",value:function(){var e=this._element.querySelector(".card__image");e.src=this._image,e.alt=this._title}},{key:"_setTitle",value:function(){this._element.querySelector(".card__title").textContent=this._title}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".card__like-button").addEventListener("click",(function(){e._handleLike()})),this._element.querySelector(".card__trash-icon").addEventListener("click",(function(){e._deleteCard()})),this._element.querySelector(".card__image").addEventListener("click",(function(){_.open(e._image,e._title),_.setEventListeners()}))}},{key:"_handleLike",value:function(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active"),this._isLiked=!this._isLiked}},{key:"_deleteCard",value:function(){this._element.remove()}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var P=function(){function e(t,n){var o=t.items,r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=o,this._renderer=r,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=t.baseUrl,this.body=t.body}var t,n;return t=e,(n=[{key:"getInitialCards",value:function(){fetch(this.baseUrl,this.body).then((function(e){return e.json()})).then((function(e){console.log(e)}))}},{key:"getUser",value:function(){fetch(this.baseUrl,this.body).then((function(e){return e.json()})).then((function(e){console.log(e)}))}}])&&I(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=t.name,this._userJob=t.job}var t,n;return t=e,n=[{key:"updateUserData",value:function(e){this._userName=e.name,this._userJob=e.job,this._setUserInfo()}},{key:"getUserInfo",value:function(){return{name:this._userName,job:this._userJob}}},{key:"_setUserInfo",value:function(){var e=this.getUserInfo(),t=document.querySelector(".info__name"),n=document.querySelector(".info__job");t.textContent=e.name,n.textContent=e.job,console.log("user set")}}],n&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),R=new P({items:p,renderer:function(e){var t=new O(e,"#card__template",{handleCardClick:function(){t.addEventListener("click",(function(){_.open(t._link,t._title)}))}});R.addItem(t.generateCard())}},".elements");R.renderItems();var U={name:y.textContent,job:b.textContent},V=new T(U);d.addEventListener("click",(function(){var e=new L({selector:"popup_user",sending:function(){var t=e._getInputValues();U={name:t["name-input"],job:t["job-input"]},V.updateUserData(U),e.close()}});v.value=y.textContent,m.value=b.textContent,e.open(),e.setEventListeners()})),h.addEventListener("click",(function(){var e=new L({selector:"popup_card",sending:function(){var t=e._getInputValues();p.push({name:t["title-input"],link:t["image-input"]});var n=new O(p[p.length-1],"#card__template",{handleCardClick:function(){n.addEventListener("click",(function(){_.open(n._link,n._title)}))}}),o=n.generateCard();R.addItem(o),e.close()}});e.open(),e.setEventListeners()})),new B({baseUrl:"https://around.nomoreparties.co/v1/web_ptbr_cohort_01/cards",body:{headers:{authorization:"4ffa3b89-8ef6-47e0-b012-e4475ed39e9b"}}}).getInitialCards(),new B({baseUrl:"https://around.nomoreparties.co/v1/web_ptbr_cohort_01/users/me",body:{headers:{authorization:"4ffa3b89-8ef6-47e0-b012-e4475ed39e9b"}}}).getUser()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxFQUFNaUcsT0FBUyxHQUFJLGtCQUFtQixDQUNuRTdELGdCQUFpQixXQUNmNEQsRUFBUS9JLGlCQUFpQixTQUFTLFdBQ2hDb0QsRUFBVzRDLEtBQUsrQyxFQUFRWCxNQUFPVyxFQUFRM0QsT0FDekMsR0FDRixJQUVJNkQsRUFBWUYsRUFBUVQsZUFDMUJKLEVBQVlHLFFBQVFZLEdBQ3BCSixFQUFROUksT0FDVixJQUVGOEksRUFBUTdDLE9BQ1I2QyxFQUFRMUUsbUJBQ1YsSUF5QmMsSUFBSXlDLEVBQUksQ0FDcEJFLFFBQVMsOERBQ1RDLEtBQU0sQ0FBRW1DLFFBQVMsQ0FBRUMsY0FBZSwyQ0FFNUJDLGtCQUNNLElBQUl4QyxFQUFJLENBQ3BCRSxRQUFTLGlFQUNUQyxLQUFNLENBQUVtQyxRQUFTLENBQUVDLGNBQWUsMkNBRTVCRSxTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2pfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qXzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qXzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJval80Ly4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3dlYl9wcm9qXzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3Jtcy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJval80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJval80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJval80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qXzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJval80Ly4vc3JjL3BhZ2UvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtzZWxlY3Rvcn1gKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihgLiR7c2VsZWN0b3J9X19jbG9zZS1idXR0b25gKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKGAke3RoaXMuX3NlbGVjdG9yfV9vcGVuZWRgKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShgJHt0aGlzLl9zZWxlY3Rvcn1fb3BlbmVkYCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChldnQpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UoZXZ0KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGAke3RoaXMuX3NlbGVjdG9yfV9vcGVuZWRgKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZm9ybVNlbGVjdG9ycywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBmb3JtU2VsZWN0b3JzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBmb3JtU2VsZWN0b3JzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGZvcm1TZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gZm9ybVNlbGVjdG9ycy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gZm9ybVNlbGVjdG9ycy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gZm9ybVNlbGVjdG9ycy5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG5cclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLXBvcHVwX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX3N1YnRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cF9fc3VidGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGltYWdlLCB0aXRsZSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaW1hZ2U7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aXRsZTtcclxuICAgIHRoaXMuX3N1YnRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9O1xyXG4iLCJpbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcblxyXG5jb25zdCBjYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbGUgZGUgWW9zZW1pdGVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIk1vbnRhbmhhcyBDYXJlY2FzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiUGFycXVlIE5hY2lvbmFsIGRhIFZhbm9pc2UgXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBlZGl0VXNlckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb19fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcImltYWdlLXBvcHVwXCIpO1xyXG5jb25zdCB1c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb19fbmFtZVwiKTtcclxuY29uc3QgdXNlckpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb19fam9iXCIpO1xyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNqb2ItaW5wdXRcIik7XHJcbmNvbnN0IHVzZXJQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdXNlclwiKTtcclxuY29uc3QgY2FyZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9jYXJkXCIpO1xyXG5jb25zdCBmb3JtU2VsZWN0b3JzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG5cclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG5cclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0XCIsXHJcblxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0X2luYWN0aXZlXCIsXHJcblxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcblxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvcl9hY3RpdmVcIixcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgY2FyZHMsXHJcbiAgZWRpdFVzZXJCdXR0b24sXHJcbiAgYWRkQnV0dG9uLFxyXG4gIGltYWdlUG9wdXAsXHJcbiAgdXNlck5hbWUsXHJcbiAgdXNlckpvYixcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXQsXHJcbiAgdXNlclBvcHVwLFxyXG4gIGNhcmRQb3B1cCxcclxuICBmb3JtU2VsZWN0b3JzLFxyXG59O1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBmb3JtU2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtcyBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHNlbGVjdG9yLCBzZW5kaW5nIH0pIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5fc2VsZWN0b3J9YClcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0cyA9IHt9O1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5fc2VsZWN0b3J9YClcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX3NlbmRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0XCIpO1xyXG4gICAgdGhpcy5fc2VuZGluZyA9IHNlbmRpbmc7XHJcbiAgfVxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2lucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQuaWQ7XHJcbiAgICAgIHRoaXMuX2lucHV0c1tgJHtpbnB1dE5hbWV9YF0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0cztcclxuICB9XHJcbiAgX2NsZWFuSW5wdXRzVmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX2lucHV0c0xpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICBjb25zdCBuZXdGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNlbGVjdG9ycywgdGhpcy5fZm9ybSk7XHJcbiAgICBuZXdGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLmJvdW5kSGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuYm91bmRIYW5kbGVDbGlja091dCk7XHJcbiAgICB0aGlzLl9zZW5kQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmJvdW5kQWRkaW5nKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmJvdW5kQ2xvc2UpO1xyXG4gICAgdGhpcy5fc2VuZEJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5ib3VuZEFkZGluZyk7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5fY2xlYW5JbnB1dHNWYWx1ZXMoKTtcclxuICB9XHJcblxyXG4gIF9hZGRpbmcoZXZ0KSB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX3NlbmRpbmcoKTtcclxuICB9XHJcbiAgX2hhbmRsZUVudGVyKGV2dCkge1xyXG4gICAgaWYgKFxyXG4gICAgICBldnQua2V5ID09IFwiRW50ZXJcIiAmJlxyXG4gICAgICB0aGlzLl9zZW5kQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImZvcm1fX3N1Ym1pdF9pbmFjdGl2ZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBfaGFuZGxlQ2xpY2tPdXQoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLmJvdW5kQ2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmJvdW5kSGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5ib3VuZEhhbmRsZUNsaWNrT3V0ID0gdGhpcy5faGFuZGxlQ2xpY2tPdXQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuYm91bmRBZGRpbmcgPSB0aGlzLl9hZGRpbmcuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuYm91bmRIYW5kbGVFbnRlciA9IHRoaXMuX2hhbmRsZUVudGVyLmJpbmQodGhpcyk7XHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuYm91bmRIYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5ib3VuZEhhbmRsZUNsaWNrT3V0KTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmJvdW5kQ2xvc2UpO1xyXG4gICAgdGhpcy5fc2VuZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5ib3VuZEFkZGluZyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmJvdW5kSGFuZGxlRW50ZXIpO1xyXG4gIH1cclxufVxyXG5leHBvcnQgeyBQb3B1cFdpdGhGb3JtcyB9O1xyXG4iLCJpbXBvcnQgeyBpbWFnZVBvcHVwIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG5jbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIHsgaGFuZGxlQ2FyZENsaWNrIH0pIHtcclxuICAgIHRoaXMuX3RpdGxlID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5faW1hZ2UgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZmFsc2U7XHJcbiAgICB0aGlzLmhhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3NldEltYWdlKCk7XHJcbiAgICB0aGlzLl9zZXRUaXRsZSgpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0SW1hZ2UoKSB7XHJcbiAgICBjb25zdCBpbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGltYWdlLnNyYyA9IHRoaXMuX2ltYWdlO1xyXG4gICAgaW1hZ2UuYWx0ID0gdGhpcy5fdGl0bGU7XHJcbiAgfVxyXG5cclxuICBfc2V0VGl0bGUoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZSgpO1xyXG4gICAgICB9KTtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtaWNvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9kZWxldGVDYXJkKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBpbWFnZVBvcHVwLm9wZW4odGhpcy5faW1hZ2UsIHRoaXMuX3RpdGxlKTtcclxuICAgICAgICBpbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2UoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9ICF0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2RlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQ2FyZCB9O1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCB7IFNlY3Rpb24gfTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLmJvZHkgPSBvcHRpb25zLmJvZHk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICBmZXRjaCh0aGlzLmJhc2VVcmwsIHRoaXMuYm9keSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcclxuICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlcigpIHtcclxuICAgIGZldGNoKHRoaXMuYmFzZVVybCwgdGhpcy5ib2R5KVxyXG4gICAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxyXG4gICAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCB7IEFwaSB9O1xyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlcikge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSB1c2VyLm5hbWU7XHJcbiAgICB0aGlzLl91c2VySm9iID0gdXNlci5qb2I7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VyRGF0YShuZXdEYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IG5ld0RhdGEubmFtZTtcclxuICAgIHRoaXMuX3VzZXJKb2IgPSBuZXdEYXRhLmpvYjtcclxuICAgIHRoaXMuX3NldFVzZXJJbmZvKCk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHsgbmFtZTogdGhpcy5fdXNlck5hbWUsIGpvYjogdGhpcy5fdXNlckpvYiB9O1xyXG4gIH1cclxuICBfc2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VyRGF0YSA9IHRoaXMuZ2V0VXNlckluZm8oKTtcclxuICAgIGNvbnN0IG5hbWVQbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb19fbmFtZVwiKTtcclxuICAgIGNvbnN0IGpvYlBsYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvX19qb2JcIik7XHJcblxyXG4gICAgbmFtZVBsYWNlLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIGpvYlBsYWNlLnRleHRDb250ZW50ID0gdXNlckRhdGEuam9iO1xyXG4gICAgY29uc29sZS5sb2coXCJ1c2VyIHNldFwiKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IHsgVXNlckluZm8gfTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybXMgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3Jtcy5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkcyxcclxuICBlZGl0VXNlckJ1dHRvbixcclxuICBhZGRCdXR0b24sXHJcbiAgaW1hZ2VQb3B1cCxcclxuICB1c2VyTmFtZSxcclxuICB1c2VySm9iLFxyXG4gIG5hbWVJbnB1dCxcclxuICBqb2JJbnB1dCxcclxufSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogY2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGl0ZW0sIFwiI2NhcmRfX3RlbXBsYXRlXCIsIHtcclxuICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgaW1hZ2VQb3B1cC5vcGVuKGNhcmQuX2xpbmssIGNhcmQuX3RpdGxlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQuZ2VuZXJhdGVDYXJkKCkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmVsZW1lbnRzXCJcclxuKTtcclxuXHJcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbmxldCB1c2VyRGF0YSA9IHsgbmFtZTogdXNlck5hbWUudGV4dENvbnRlbnQsIGpvYjogdXNlckpvYi50ZXh0Q29udGVudCB9O1xyXG5jb25zdCBwYWdlVXNlciA9IG5ldyBVc2VySW5mbyh1c2VyRGF0YSk7XHJcblxyXG5lZGl0VXNlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IFVzZXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm1zKHtcclxuICAgIHNlbGVjdG9yOiBcInBvcHVwX3VzZXJcIixcclxuICAgIHNlbmRpbmc6ICgpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXRzID0gVXNlckZvcm0uX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgIHVzZXJEYXRhID0ge1xyXG4gICAgICAgIG5hbWU6IGlucHV0c1tcIm5hbWUtaW5wdXRcIl0sXHJcbiAgICAgICAgam9iOiBpbnB1dHNbXCJqb2ItaW5wdXRcIl0sXHJcbiAgICAgIH07XHJcbiAgICAgIHBhZ2VVc2VyLnVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKTtcclxuICAgICAgVXNlckZvcm0uY2xvc2UoKTtcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJOYW1lLnRleHRDb250ZW50O1xyXG4gIGpvYklucHV0LnZhbHVlID0gdXNlckpvYi50ZXh0Q29udGVudDtcclxuICBVc2VyRm9ybS5vcGVuKCk7XHJcbiAgVXNlckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxufSk7XHJcblxyXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBBZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm1zKHtcclxuICAgIHNlbGVjdG9yOiBcInBvcHVwX2NhcmRcIixcclxuICAgIHNlbmRpbmc6ICgpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXRzID0gQWRkRm9ybS5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgY2FyZHMucHVzaCh7IG5hbWU6IGlucHV0c1tcInRpdGxlLWlucHV0XCJdLCBsaW5rOiBpbnB1dHNbXCJpbWFnZS1pbnB1dFwiXSB9KTtcclxuICAgICAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKGNhcmRzW2NhcmRzLmxlbmd0aCAtIDFdLCBcIiNjYXJkX190ZW1wbGF0ZVwiLCB7XHJcbiAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICBuZXdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGltYWdlUG9wdXAub3BlbihuZXdDYXJkLl9saW5rLCBuZXdDYXJkLl90aXRsZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc3QgY2FyZFRvQWRkID0gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkVG9BZGQpO1xyXG4gICAgICBBZGRGb3JtLmNsb3NlKCk7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIEFkZEZvcm0ub3BlbigpO1xyXG4gIEFkZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxufSk7XHJcblxyXG4vKiB0ZW1wIFxyXG5mZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX3B0YnJfY29ob3J0XzAxL2NhcmRzXCIsIHtcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjRmZmEzYjg5LThlZjYtNDdlMC1iMDEyLWU0NDc1ZWQzOWU5YlwiLFxyXG4gIH0sXHJcbn0pXHJcbiAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gIH0pO1xyXG5mZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX3B0YnJfY29ob3J0XzAxL3VzZXJzL21lXCIsIHtcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjRmZmEzYjg5LThlZjYtNDdlMC1iMDEyLWU0NDc1ZWQzOWU5YlwiLFxyXG4gIH0sXHJcbn0pXHJcbiAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gIH0pO1xyXG5jb25zb2xlLmxvZyhcclxuICBgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWBcclxuKTsgKi9cclxubGV0IHRlc3RBcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX3B0YnJfY29ob3J0XzAxL2NhcmRzXCIsXHJcbiAgYm9keTogeyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IFwiNGZmYTNiODktOGVmNi00N2UwLWIwMTItZTQ0NzVlZDM5ZTliXCIgfSB9LFxyXG59KTtcclxudGVzdEFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcclxubGV0IHVzZXJBcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX3B0YnJfY29ob3J0XzAxL3VzZXJzL21lXCIsXHJcbiAgYm9keTogeyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IFwiNGZmYTNiODktOGVmNi00N2UwLWIwMTItZTQ0NzVlZDM5ZTliXCIgfSB9LFxyXG59KTtcclxudXNlckFwaS5nZXRVc2VyKCk7XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsInNlbGVjdG9yIiwidGhpcyIsIl9zZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jbG9zZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImV2dCIsImtleSIsImNsb3NlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NDbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiRm9ybVZhbGlkYXRvciIsImZvcm1TZWxlY3RvcnMiLCJmb3JtRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiX3RvZ2dsZVN1Ym1pdEJ1dHRvbiIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwiUG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfc3VidGl0bGUiLCJpbWFnZSIsInRpdGxlIiwic3JjIiwiYWx0IiwiY2FyZHMiLCJuYW1lIiwibGluayIsImVkaXRVc2VyQnV0dG9uIiwiYWRkQnV0dG9uIiwiaW1hZ2VQb3B1cCIsInVzZXJOYW1lIiwidXNlckpvYiIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwiUG9wdXBXaXRoRm9ybXMiLCJzZW5kaW5nIiwiX2Zvcm0iLCJfaW5wdXRzIiwiX3NlbmRCdXR0b24iLCJfc2VuZGluZyIsIl9pbnB1dHNMaXN0IiwiaW5wdXQiLCJpbnB1dE5hbWUiLCJ2YWx1ZSIsInNldEV2ZW50TGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImJvdW5kSGFuZGxlRXNjQ2xvc2UiLCJib3VuZEhhbmRsZUNsaWNrT3V0IiwiYm91bmRBZGRpbmciLCJib3VuZENsb3NlIiwiX2NsZWFuSW5wdXRzVmFsdWVzIiwicHJldmVudERlZmF1bHQiLCJiaW5kIiwiX2hhbmRsZUNsaWNrT3V0IiwiX2FkZGluZyIsImJvdW5kSGFuZGxlRW50ZXIiLCJfaGFuZGxlRW50ZXIiLCJDYXJkIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsIl90aXRsZSIsIl9jYXJkU2VsZWN0b3IiLCJfaXNMaWtlZCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3NldEltYWdlIiwiX3NldFRpdGxlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVMaWtlIiwiX2RlbGV0ZUNhcmQiLCJvcGVuIiwidG9nZ2xlIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW0iLCJBcGkiLCJvcHRpb25zIiwiYmFzZVVybCIsImJvZHkiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJqc29uIiwicmVzdWx0IiwiY29uc29sZSIsImxvZyIsIlVzZXJJbmZvIiwidXNlciIsIl91c2VyTmFtZSIsIl91c2VySm9iIiwiam9iIiwibmV3RGF0YSIsIl9zZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiZ2V0VXNlckluZm8iLCJuYW1lUGxhY2UiLCJqb2JQbGFjZSIsImNhcmRTZWN0aW9uIiwiY2FyZCIsIl9saW5rIiwiYWRkSXRlbSIsImdlbmVyYXRlQ2FyZCIsInJlbmRlckl0ZW1zIiwicGFnZVVzZXIiLCJVc2VyRm9ybSIsImlucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsInVwZGF0ZVVzZXJEYXRhIiwiQWRkRm9ybSIsInB1c2giLCJuZXdDYXJkIiwibGVuZ3RoIiwiY2FyZFRvQWRkIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VyIl0sInNvdXJjZVJvb3QiOiIifQ==